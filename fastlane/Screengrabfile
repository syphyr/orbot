# For more information about all available options run:
# fastlane action screngrab

# once you're ready to start taking screenshots, don't forget to run:
# ./gradlew clean assembleFullpermDebug assembleFullPermdebugAndroidTest

# LANGUAGE SETTINGS
# you can re-run a specific screenshot for a specific locale, by passing an array to locales
# locale, and then calling use_tests_in_classes() below with an array of one test... Setting clear
# screenshots to true
# default. every locale that we're tryign to maintain screenshots of
ALL_LOCALES_WE_TRACK = ['en-US', 'fr-FR', 'es-MX', 'de-DE', 'ar', 'he', 'tr', 'pt', 'ja', 'hi', 'ru', 'ko']

# get screenshots for all loacles, excluding the ones in this array
# useful if some screenshots aren't coming out good for some locales, and others are.
# just exclude the good ones and rerun fastlane screengrab
BUT_SKIP_THESE_ONES = [] # dont skip any, default...
# BUT_SKIP_THESE_ONES = ['en-US', 'fr-FR', 'hi', 'pt']

ALL_LOCALES_WE_TRACK -= BUT_SKIP_THESE_ONES # [1, 2, 3] - [2] == [1, 3]

locales(ALL_LOCALES_WE_TRACK) # default run everything, except the ones we're passing on
# locales(['fa']) # just Farsi...
# locales(['en-US'])
# locales(['en-US', 'fa', 'fr-FR'])


# TESTS TO RUN
PREFIX = 'org.torproject.android.Screenshot'
# full class names, helper variables for use_tests_in_classes below...
CHOOSE_APPS = PREFIX + 'ChooseApps'
CHOOSE_HOW_TO_CONNECT = PREFIX + 'ChooseHowToConnect'
CONNECTED_SCREEN = PREFIX + 'Connected'
KINDNESS_SCREEN = PREFIX + 'KindnessModeFragment'
MORE_SCREEN = PREFIX + 'MoreFragment'
SETTINGS = PREFIX + 'Settings'

# uncomment ONE of these to only run certain test(s), otherwise Screengrab will run every test defiend
# in the package org.torproject.android, even if there's no variable defined for it above... 
# Keep these all commented out during commits...
	
# CHOOSE_APPS makes a toast, that sometimes sneaks its way into other screenshots, run it in isolation
# also for whatever reason, CHOOSE_APPS only works if another test runs before it... IDK right now. 
# runs all, with pesky CHOOSE_APPS last..
# use_tests_in_classes([CHOOSE_HOW_TO_CONNECT, CONNECTED_SCREEN, KINDNESS_SCREEN, MORE_SCREEN, SETTINGS, CHOOSE_APPS])	

# use_tests_in_classes([CHOOSE_HOW_TO_CONNECT, CHOOSE_APPS])

use_tests_in_classes([CHOOSE_HOW_TO_CONNECT, CONNECTED_SCREEN, KINDNESS_SCREEN, MORE_SCREEN, SETTINGS, CHOOSE_APPS])	

# clear all previously generated screenshots in your local output directory before creating new ones
# if you're running multiple rounds of fastlane screengrab, and especially if use_timestamp_suffix.
# if true, this deletes ALL screenshots in the repository, even if you are only redoing a specific one.
#
# IF YOU ARE REDOIGN ANY SCREENSHOTS YOU WANT THIS TO BE TRUE. Then just git commit the new screenshot.
clear_previous_screenshots(true)

# default behavior is to exit once a test fails. If you exit on failure, none of the successful 
# screenshots captured before the failure will be copied and saved... useful to have as false if
# tests are FAILING(not passing, not making unwanted screenshots) in some locales and not others
exit_on_test_failure(true) 


# an APK produced by ./gradlew assembleFullpermDebug that can run on your emulator's ABI
# but for convenience, you can set this to the file you select in fastlane screengrab prompt...
APP_APK_DIR= 'app/build/outputs/apk/fullperm/debug/'
APP_APK_FILENAME= 'Orbot-' + `#{'git describe --tags --always'}`.strip + '-fullperm-universal-debug.apk'	

# shouldn't change, APK generated by ./gradlew assembleFullPermdebugAndroidTest
TEST_APK = 'app/build/outputs/apk/androidTest/fullperm/debug/app-fullperm-debug-androidTest.apk'

# if you comment out either of these, fastlane gives you an interactive prompt and tries to help you
# find the right app and test APKs...
app_apk_path(APP_APK_DIR + APP_APK_FILENAME)
tests_apk_path(TEST_APK)

# package for Orbot APK (not the test APK)
app_package_name('org.torproject.android.debug')

# if false, A-orbot_connected_1754320391454.png becomes A-orbot_connected.png... easier to embed in HTML site
use_timestamp_suffix(false) 
reinstall_app(true) # clears app data and settings if there are any, probably what you desire...
skip_open_summary(true) 
device_type('phone') # one: of phone, sevenInch, tenInch, tv, wear